import{getContext as t,store as e}from"@wordpress/interactivity";function i(t){const e=document.querySelector(".frs-profile__links-edit-list");e&&(e.innerHTML=t.map((t,e)=>`\n\t\t<div class="frs-profile__link-edit-item" data-index="${e}">\n\t\t\t<input \n\t\t\t\ttype="text" \n\t\t\t\tclass="frs-profile__edit-input" \n\t\t\t\tvalue="${o(t.title||"")}"\n\t\t\t\tdata-wp-on--input="actions.updateLinkTitle"\n\t\t\t\tdata-index="${e}"\n\t\t\t\tplaceholder="Link Title"\n\t\t\t>\n\t\t\t<input \n\t\t\t\ttype="url" \n\t\t\t\tclass="frs-profile__edit-input" \n\t\t\t\tvalue="${o(t.url||"")}"\n\t\t\t\tdata-wp-on--input="actions.updateLinkUrl"\n\t\t\t\tdata-index="${e}"\n\t\t\t\tplaceholder="https://example.com"\n\t\t\t>\n\t\t\t<button \n\t\t\t\ttype="button" \n\t\t\t\tclass="frs-profile__link-remove-btn"\n\t\t\t\tdata-wp-on--click="actions.removeLink"\n\t\t\t\tdata-index="${e}"\n\t\t\t\ttitle="Remove link"\n\t\t\t>\n\t\t\t\t<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n\t\t\t\t\t<line x1="18" y1="6" x2="6" y2="18"></line>\n\t\t\t\t\t<line x1="6" y1="6" x2="18" y2="18"></line>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\t`).join(""))}function o(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}e("frs/profile-editor",{state:{get isDesktop(){return"desktop"===t().previewDevice},get isTablet(){return"tablet"===t().previewDevice},get isMobile(){return"mobile"===t().previewDevice}},actions:{flip(){const e=t();e.isFlipped=!e.isFlipped},toggleEdit(){const e=t();e.isEditing=!e.isEditing,!e.isEditing&&e.originalProfile&&(e.profile=JSON.parse(JSON.stringify(e.originalProfile))),e.isEditing&&(e.originalProfile=JSON.parse(JSON.stringify(e.profile)))},updateField(e){const i=t(),o=e.target.dataset.field,r=e.target.value;o&&i.profile&&(i.profile[o]=r)},toggleSpecialty(e){const i=t(),o=e.target.value,r=e.target.checked;i.profile.specialties_lo||(i.profile.specialties_lo=[]),r?i.profile.specialties_lo.includes(o)||(i.profile.specialties_lo=[...i.profile.specialties_lo,o]):i.profile.specialties_lo=i.profile.specialties_lo.filter(t=>t!==o)},toggleCertification(e){const i=t(),o=e.target.value,r=e.target.checked;i.profile.namb_certifications||(i.profile.namb_certifications=[]),r?i.profile.namb_certifications.includes(o)||(i.profile.namb_certifications=[...i.profile.namb_certifications,o]):i.profile.namb_certifications=i.profile.namb_certifications.filter(t=>t!==o)},toggleServiceArea(e){const i=t(),o=e.target.value,r=e.target.checked;i.profile.service_areas||(i.profile.service_areas=[]),r?i.profile.service_areas.includes(o)||(i.profile.service_areas=[...i.profile.service_areas,o]):i.profile.service_areas=i.profile.service_areas.filter(t=>t!==o)},updateLinkTitle(e){const i=t(),o=parseInt(e.target.dataset.index,10),r=e.target.value;i.profile.custom_links||(i.profile.custom_links=[]),i.profile.custom_links[o]&&(i.profile.custom_links[o].title=r)},updateLinkUrl(e){const i=t(),o=parseInt(e.target.dataset.index,10),r=e.target.value;i.profile.custom_links||(i.profile.custom_links=[]),i.profile.custom_links[o]&&(i.profile.custom_links[o].url=r)},addLink(){const e=t();e.profile.custom_links||(e.profile.custom_links=[]),e.profile.custom_links=[...e.profile.custom_links,{title:"",url:""}],i(e.profile.custom_links)},removeLink(e){const o=t(),r=parseInt(e.target.closest("[data-index]").dataset.index,10);o.profile.custom_links&&void 0!==o.profile.custom_links[r]&&(o.profile.custom_links=o.profile.custom_links.filter((t,e)=>e!==r),i(o.profile.custom_links))},setDesktop(){t().previewDevice="desktop"},setTablet(){t().previewDevice="tablet"},setMobile(){t().previewDevice="mobile"},async saveProfile(){const e=t();if(!e.isSaving){e.isSaving=!0;try{const t={job_title:e.profile.job_title||"",city_state:e.profile.city_state||"",email:e.profile.email||"",phone_number:e.profile.phone_number||"",biography:e.profile.biography||"",website:e.profile.website||"",facebook_url:e.profile.facebook_url||"",instagram_url:e.profile.instagram_url||"",linkedin_url:e.profile.linkedin_url||"",twitter_url:e.profile.twitter_url||"",specialties_lo:e.profile.specialties_lo||[],namb_certifications:e.profile.namb_certifications||[],service_areas:e.profile.service_areas||[],custom_links:e.profile.custom_links||[]},i=e.profile.id||e.userId,o=await fetch(`/wp-json/frs-users/v1/profiles/${i}`,{method:"PUT",headers:{"Content-Type":"application/json","X-WP-Nonce":window.frsProfileEditor?.nonce||""},body:JSON.stringify(t)});if(!o.ok){const t=await o.json().catch(()=>({}));throw new Error(t.message||"Failed to save profile")}e.originalProfile=JSON.parse(JSON.stringify(e.profile)),e.isEditing=!1,window.dispatchEvent(new CustomEvent("frs:profileSaved",{detail:{success:!0}})),window.location.reload()}catch(t){console.error("Save failed:",t),window.dispatchEvent(new CustomEvent("frs:profileSaved",{detail:{success:!1,error:t.message}})),alert("Failed to save profile: "+t.message)}finally{e.isSaving=!1}}}}});